# üîß –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø - 31 –æ–∫—Ç—è–±—Ä—è 2025

## üö® –û–°–ù–û–í–ù–´–ï –ü–†–û–ë–õ–ï–ú–´, –ö–û–¢–û–†–´–ï –ë–´–õ–ò –ò–°–ü–†–ê–í–õ–ï–ù–´

### –ü—Ä–æ–±–ª–µ–º–∞ 1: FirebaseException is not a subtype of JavaScriptObject
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **–≤–µ–±-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ**, –Ω–æ —ç–∫—Ä–∞–Ω—ã –ø—ã—Ç–∞–ª–∏—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Firebase Firestore –Ω–∞–ø—Ä—è–º—É—é, —á—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≤–∞—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —ç–∫—Ä–∞–Ω—ã —Ç–µ–ø–µ—Ä—å **–ø–ª–∞—Ç—Ñ–æ—Ä–º–æ-–∑–∞–≤–∏—Å–∏–º—ã–µ**:
- **Web:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç REST API —á–µ—Ä–µ–∑ WebGroupService –∏ WebLessonService
- **Mobile:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç Firebase Firestore –Ω–∞–ø—Ä—è–º—É—é

### –ü—Ä–æ–±–ª–µ–º–∞ 2: FormatException: Unexpected token '<', "<!DOCTYPE "... is not valid JSON
**–ü—Ä–∏—á–∏–Ω–∞:** REST API —Å–µ—Ä–≤–µ—Ä (backend) –ù–ï –ó–ê–ü–£–©–ï–ù. Web-–≤–µ—Ä—Å–∏—è –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ `http://localhost:3000/api`, –Ω–æ –ø–æ–ª—É—á–∞–µ—Ç HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—à–∏–±–æ–∫ –≤–º–µ—Å—Ç–æ JSON.

**–†–µ—à–µ–Ω–∏–µ:** –ù—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å backend —Å–µ—Ä–≤–µ—Ä (—Å–º. —Ä–∞–∑–¥–µ–ª "–ó–∞–ø—É—Å–∫ Backend" –Ω–∏–∂–µ).

### –ü—Ä–æ–±–ª–µ–º–∞ 3: setState() called after dispose()
**–ü—Ä–∏—á–∏–Ω–∞:** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∏—Å—å –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤–∏–¥–∂–µ—Ç—ã –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –¥–µ—Ä–µ–≤–∞.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ `if (!mounted) return;` –≤–æ –≤—Å–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã.

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –§–ê–ô–õ–´

### 1. **lib/screens/group/groups_screen.dart**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ web –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —á–µ—Ä–µ–∑ REST API
- ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –Ω–∞ web
- ‚úÖ –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è web
- ‚úÖ Fallback –Ω–∞ Firebase –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
```dart
// Web: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç WebGroupService
List<GroupModel> _webGroups = [];
Timer? _refreshTimer;

// Mobile: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Firebase Firestore StreamBuilder
```

### 2. **lib/screens/lesson/lessons_screen.dart**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ web –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —á–µ—Ä–µ–∑ REST API
- ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –Ω–∞ web
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–Ω—è—Ç–∏–π –ø–æ —Ç–∏–ø—É (–°–µ–≥–æ–¥–Ω—è/–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ/–ü—Ä–æ—à–µ–¥—à–∏–µ) —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ–±–µ–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö
- ‚úÖ –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è web

### 3. **lib/screens/lesson/qr_display_screen_enhanced.dart**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ web –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ `mounted` –≤–æ –≤—Å–µ async –º–µ—Ç–æ–¥—ã –∏ —Ç–∞–π–º–µ—Ä—ã
- ‚úÖ QR-–∫–æ–¥ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ–±–µ–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```dart
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ setState –≤ —Ç–∞–π–º–µ—Ä–µ
if (!mounted) {
  timer.cancel();
  return;
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ async –æ–ø–µ—Ä–∞—Ü–∏–π
if (!mounted) return;
setState(() => ...);
```

### 4. **lib/screens/reports/group_report_screen.dart**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ `if (!mounted) return;` –ø–µ—Ä–µ–¥ –≤—Å–µ–º–∏ `setState()`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –≤ async –º–µ—Ç–æ–¥–∞—Ö

---

## üöÄ –ö–ê–ö –ó–ê–ü–£–°–¢–ò–¢–¨ –ü–†–ò–õ–û–ñ–ï–ù–ò–ï

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (Firebase —Ç–æ–ª—å–∫–æ)
```bash
cd c:\Users\Remus\OneDrive\Desktop\projectnash
flutter run
```
‚úÖ –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ë–ï–ó backend —Å–µ—Ä–≤–µ—Ä–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç Firebase –Ω–∞–ø—Ä—è–º—É—é)

### –í–∞—Ä–∏–∞–Ω—Ç 2: Web –≤–µ—Ä—Å–∏—è (—Ç—Ä–µ–±—É–µ—Ç Backend)

#### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å Backend API —Å–µ—Ä–≤–µ—Ä
```bash
cd c:\Users\Remus\OneDrive\Desktop\projectnash\server
npm install  # –µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm run dev
```
**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
üöÄ Server running on http://localhost:3000
üìä Database: Connected
```

#### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç—å Flutter Web
```bash
cd c:\Users\Remus\OneDrive\Desktop\projectnash
flutter run -d chrome
```

---

## üîç –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–õ–ê–¢–§–û–†–ú

### Web Platform (kIsWeb = true)
```
Flutter Web App
    ‚Üì
WebGroupService / WebLessonService
    ‚Üì
ApiService (HTTP REST)
    ‚Üì
Backend API Server (http://localhost:3000)
    ‚Üì
PostgreSQL Database
```

### Mobile Platform (kIsWeb = false)
```
Flutter Mobile App
    ‚Üì
Firebase SDK
    ‚Üì
Cloud Firestore
```

---

## üìã –ü–†–û–í–ï–†–û–ß–ù–´–ô –°–ü–ò–°–û–ö

### –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º Web-–≤–µ—Ä—Å–∏–∏:
- [ ] Backend —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000
- [ ] PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
- [ ] `.env` —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ø–∞–ø–∫–µ `server/`
- [ ] –í–∏–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ "üöÄ Server running on http://localhost:3000"

### –ï—Å–ª–∏ Web-–≤–µ—Ä—Å–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω** - –æ—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000 –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞** (F12) –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ CORS –∏–ª–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞** - —Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ backend —Å–µ—Ä–≤–µ—Ä–∞

### –ï—Å–ª–∏ Mobile-–≤–µ—Ä—Å–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** (google-services.json –¥–ª—è Android, GoogleService-Info.plist –¥–ª—è iOS)
2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Firebase –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –≤ Firebase Console

---

## üéØ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

### ‚úÖ –†–ê–ë–û–¢–ê–ï–¢:
- –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (Android/iOS) —Å Firebase
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –≥—Ä—É–ø–ø (–æ–±–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–Ω—è—Ç–∏–π (–æ–±–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
- QR-–∫–æ–¥—ã –¥–ª—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ (–æ–±–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
- –û—Ç—á–µ—Ç—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–æ–±–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ web

### ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –í–ù–ò–ú–ê–ù–ò–Ø:
- Backend —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –¥–ª—è web-–≤–µ—Ä—Å–∏–∏
- PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è backend

### üîÑ –ê–í–¢–û–û–ë–ù–û–í–õ–ï–ù–ò–ï:
- **Web:** –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ —á–µ—Ä–µ–∑ REST API
- **Mobile:** –†–µ–∞–ª-—Ç–∞–π–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Firebase Firestore StreamBuilder

---

## üí° –°–û–í–ï–¢–´ –ü–û –û–¢–õ–ê–î–ö–ï

### –õ–æ–≥–∏ Backend —Å–µ—Ä–≤–µ—Ä–∞:
```bash
cd server
npm run dev
# –°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å
```

### –õ–æ–≥–∏ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
flutter run -v
# –í–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –ª–æ–≥–æ–≤
```

### –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:
```bash
flutter clean
flutter pub get
flutter run
```

---

## üìù –ü–†–ò–ú–ï–ß–ê–ù–ò–Ø

1. **Web vs Mobile:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ `kIsWeb` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π data source
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ù–∞ production –∑–∞–º–µ–Ω–∏—Ç–µ `JWT_SECRET` –≤ `.env` —Ñ–∞–π–ª–µ
3. **CORS:** Backend –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ª—é–±—ã—Ö –¥–æ–º–µ–Ω–æ–≤ (–¥–ª—è production –æ–≥—Ä–∞–Ω–∏—á—å—Ç–µ —ç—Ç–æ)

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 31 –æ–∫—Ç—è–±—Ä—è 2025, 14:00
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–ø—É—Å—Ç–∏—Ç—å backend —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã web-–≤–µ—Ä—Å–∏–∏
